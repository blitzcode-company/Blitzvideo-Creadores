<app-header></app-header>
<div class="form-wrapper-canal">
  <div class="form-container-canal">
    <div class="form-header">
      <h2><mat-icon>account_circle</mat-icon> Crea tu canal</h2>
    </div>
    
    <div class="form-content-canal">
      <form #dataform="ngForm" (ngSubmit)="crearCanal()">
        
        <div class="form-group-canal">
          <mat-form-field appearance="outline" class="canal-field">
            <mat-label>Nombre del canal</mat-label>
            <input matInput [(ngModel)]="canal.nombre" name="nombre" required>
          </mat-form-field>
        </div>

        <div class="form-group-canal">
          <mat-form-field appearance="outline" class="canal-field">
            <mat-label>Descripci√≥n</mat-label>
            <textarea matInput [(ngModel)]="canal.descripcion" name="descripcion" rows="3" required></textarea>
          </mat-form-field>
        </div>

        <div class="upload-section-canal">
          <label class="upload-label-canal">
            <mat-icon>photo_camera</mat-icon>
            Portada del canal (1200x675 recomendada)
            <input type="file" (change)="onFileSelected($event)" accept="image/*" required class="hidden-file">
          </label>
          <img *ngIf="canal.portadaPreview" [src]="canal.portadaPreview" class="cover-preview-canal">
          <img *ngIf="!canal.portadaPreview" src="assets/images/cover-default.png" class="cover-preview-canal">
        </div>

        <mat-progress-bar *ngIf="uploadProgress > 0" 
                          mode="determinate" 
                          [value]="uploadProgress"
                          class="canal-progress"></mat-progress-bar>

        <div class="form-actions-canal">
          <button mat-raised-button 
                  color="primary" 
                  type="submit" 
                  [disabled]="dataform.invalid || uploading"
                  class="canal-submit-btn">
            <mat-icon>check</mat-icon>
            {{ uploading ? 'Creando... ' + uploadProgress + '%' : 'Crear canal' }}
          </button>
        </div>
      </form>

      <div *ngFor="let alerta of alerta" 
           class="canal-alert" 
           [ngClass]="{'success': alerta.type === 'success', 'error': alerta.type === 'error'}">
        {{ alerta.message }}
      </div>
    </div>
  </div>
</div>